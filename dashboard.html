<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width,initial-scale=1,viewport-fit=cover"
  />
  <title data-i18n="Master Control Center">Master Control Center</title>
  <link rel="manifest" href="app-manifest.json">
  <link rel="icon" type="image/svg+xml" href="assets/icon/stackdash.svg" />
  <link rel="icon" type="image/png" sizes="16x16" href="assets/icon/stackdash-16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icon/stackdash-32.png" />
  <link rel="icon" type="image/png" sizes="128x128" id="faviconPng" href="assets/icon/stackdash-128.png" />
  <link rel="shortcut icon" href="assets/icon/stackdash-32.png" />
  <link rel="apple-touch-icon" sizes="128x128" href="assets/icon/stackdash-128.png" />
  <link rel="stylesheet" href="css/dashboard.css" />
</head>
<body>
  <div id="app" class="app">
<header class="topbar">
      <div class="topbar-title">
        <img class="logo" src="assets/icon/stackdash-128.png" alt="Master Control Center icon" />
        <span data-i18n="Master Control Center">Master Control Center</span>
      </div>
      <nav class="pages" id="pagesBar" aria-label="Pages"></nav>

      <div class="topbar-actions">
        <button class="btn small" data-action="addPage" data-i18n="Add Page" data-i18n-title="Add Page" title="Add Page">Add Page</button>
        <button class="btn small" data-action="toggleSettings" data-i18n="Settings" data-i18n-title="Settings" title="Settings" aria-controls="settingsPanel">Settings</button>
        <button class="btn small" id="install-button" style="display: none;" data-i18n="InstallPage" data-i18n-title="InstallPage" title="InstallPage">Install Page</button>
      </div>
    </header>

    <main class="content">
      <div id="groupsContainer" class="groups"></div>
    </main>

    <!-- Slide-out settings -->
        <aside id="settingsPanel" class="settings" aria-label="Settings">
          <div class="settings-header">
              <h2 data-i18n="Settings">Settings</h2>
              <button class="btn" data-action="toggleSettings" data-i18n="Close" data-i18n-title="Close" title="Close">Close</button>
          </div>
          <div class="settings-body">
            <!-- Tabs -->
            <div class="settings-tabs" role="tablist" aria-label="Settings Tabs">
              <button role="tab" id="tab-general"   data-tab="general"   aria-controls="panel-general"   aria-selected="true" data-i18n="General">General</button>
              <button role="tab" id="tab-data"      data-tab="data"      aria-controls="panel-data"      aria-selected="false" data-i18n="Data">Data</button>
              <button role="tab" id="tab-api"       data-tab="api"       aria-controls="panel-api"       aria-selected="false" data-i18n="APIS">APIS</button>
              <button role="tab" id="tab-advanced"  data-tab="advanced"  aria-controls="panel-advanced"  aria-selected="false" data-i18n="Advanced">Advanced</button>
              <button role="tab" id="tab-repair"    data-tab="repair"    aria-controls="panel-repair"    aria-selected="false" title="Curated diagnostics and repair" aria-label="PC/Fixes">PC/Fixes</button>
              <button role="tab" id="tab-logs"      data-tab="logs"      aria-controls="panel-logs"      aria-selected="false">Logs</button>
              <button role="tab" id="tab-credits"   data-tab="credits"   aria-controls="panel-credits"   aria-selected="false" data-i18n="Credits">Credits</button>
            </div>

            <div class="tab-panels">
              <!-- General Tab -->
              <div id="panel-general" class="tab-panel active" role="tabpanel" aria-labelledby="tab-general">
                <section>
                  <h3 data-i18n="Localization">Localization</h3>
                  <p data-i18n="Customize basic dashboard preferences. Additional options coming soon.">Customize basic dashboard preferences. Additional options coming soon.</p>
                  <div class="form-grid" style="grid-template-columns:160px 1fr;align-items:center;">
                    <label for="prefInterfaceLanguage" data-i18n="Interface language">Interface language</label>
                    <select id="prefInterfaceLanguage" name="prefInterfaceLanguage">
                      <option value="en" selected data-i18n="English">English</option>
                      <option value="es" data-i18n="Spanish">Spanish</option>
                      <option value="fr" data-i18n="French">French</option>
                      <option value="de" data-i18n="German">German</option>
                      <option value="de-ch" data-i18n="Swiss German">Swiss German</option>
                      <option value="nl" data-i18n="Dutch">Dutch</option>
                      <option value="it" data-i18n="Italian">Italian</option>
                      <option value="pt" data-i18n="Portuguese">Portuguese</option>
                    </select>
                  </div>
                  <small class="muted" data-i18n="Choose how the dashboard text is translated.">Choose how the dashboard text is translated.</small>
                </section>
                <section>
                  <h3 data-i18n="Theme">Theme</h3>
                  <div class="form-grid" style="grid-template-columns:140px 1fr; align-items:center;">
                    <label for="prefTheme" data-i18n="Theme">Theme</label>
                    <select id="prefTheme">
                      <option value="system" data-i18n="System">System</option>
                      <option value="light" data-i18n="Light">Light</option>
                      <option value="dark" data-i18n="Dark">Dark</option>
                      <option value="crimson" data-i18n="Crimson Dark">Crimson Dark</option>
                    </select>
                    <label for="prefFont" data-i18n="Font">Font</label>
                    <select id="prefFont"></select>
                  </div>
                  <div class="font-search-row" style="margin-top:8px;">
                    <input id="prefFontSearch" type="text" placeholder="Search fonts…" aria-label="Search fonts" data-i18n-placeholder="Search fonts…" data-i18n-aria-label="Search fonts…" />
                    <button id="prefFontTest" class="btn small" type="button" style="margin-left:8px;" data-i18n="Select Font" data-i18n-title="Select Font" title="Select Font">Select Font</button>
                    </div>
                    <div class="glow-controls" style="display:flex;align-items:center;gap:20px;margin-top:14px;flex-wrap:wrap;">
                    <label class="switch" aria-label="Glow effect toggle" data-i18n-aria-label="Glow effect toggle" style="display:inline-flex;align-items:center;gap:8px;">
                      <input id="prefGlowEnabled" type="checkbox" checked />
                      <span class="switch-track" aria-hidden="true"></span>
                      <span class="switch-label-on" aria-hidden="true" data-i18n="On">On</span>
                      <span class="switch-label-off" aria-hidden="true" data-i18n="Off">Off</span>
                    </label>
                    <label style="display:flex;align-items:center;gap:10px;">
                <span style="font-weight:600;" data-i18n="Glow Color">Glow Color</span>

                <div class="color-picker-wrapper"
                     style="position: relative;
                            width: 46px;
                            height: 32px;
                            border-radius: 8px;
                            border: 1px solid var(--border);
                            background-color: #8b1234; /* Cor inicial */
                            overflow: hidden; /* Garante que o input não vaze */
                            cursor: pointer;">

                  <input id="prefGlowColor" type="color" value="#8b1234"
                         style="position: absolute;
                                top: 0;
                                left: 0;
                                width: 100%;
                                height: 100%;
                                opacity: 0; /* Totalmente invisível */
                                border: none;
                                padding: 0;
                                cursor: pointer;"
                         aria-label="Glow color" data-i18n-aria-label="Glow color" />
                </div>
              </label>
                  </div>
                  <small class="muted" data-i18n="Choose light / dark or follow system preference.">Choose light / dark or follow system preference.</small>
                  <div style="margin-top:10px;">
                    <button id="prefGlowReset" type="button" class="btn small" title="Reset glow color to default" data-i18n="Reset Glow" data-i18n-title="Reset glow color to default">Reset Glow</button>
                  </div>
                </section>
                <section>
                  <h3 data-i18n="Edit Mode">Edit Mode</h3>
                  <div class="form-grid" style="grid-template-columns:auto;align-items:center;">
                    <label class="switch" style="justify-self:start;" aria-label="Edit toggle" data-i18n-aria-label="Edit toggle">
                      <input id="prefEditMode" type="checkbox" />
                      <span class="switch-track" aria-hidden="true"></span>
                      <span class="switch-label-on" aria-hidden="true" data-i18n="On">On</span>
                      <span class="switch-label-off" aria-hidden="true" data-i18n="Off">Off</span>
                    </label>
                  </div>
                  <small class="muted" data-i18n="Turn off to hide menus, drag handles, and add buttons.">Turn off to hide menus, drag handles, and add buttons.</small>
                </section>
                <section>
                </section>
              </div>

              <!-- Data Tab -->
              <div id="panel-data" class="tab-panel" role="tabpanel" aria-labelledby="tab-data" hidden>
                <section>
                  <h3 data-i18n="Backup">Backup</h3>
                  <div class="row">
                    <button class="btn" data-action="exportJson" data-i18n="Export JSON" data-i18n-title="Export JSON">Export JSON</button>
                    <label class="btn file">
                      <span data-i18n="Import JSON">Import JSON</span>
                      <input type="file" id="importJsonFile" accept="application/json" />
                    </label>
                  </div>
                </section>
                <section>
                  <h3 data-i18n="Danger ⚠️">Danger ⚠️</h3>
                  <button class="btn danger" data-action="resetAll" data-i18n="Reset all data" data-i18n-title="Reset all data">Reset all data</button>
                </section>
              </div>

              <!-- API Tab -->
              <div id="panel-api" class="tab-panel" role="tabpanel" aria-labelledby="tab-api" hidden>
                <section>
                  <h3 data-i18n="logo.dev">logo.dev</h3>
                  <div class="form-grid">
                    <label for="prefLogoDevKey" data-i18n="API Key">API Key</label>
                    <input id="prefLogoDevKey" type="text" placeholder="sk_xxx..." autocomplete="off" data-i18n-placeholder="sk_xxx..." />
                  </div>
                  <small class="muted" data-i18n="Stored locally">Stored locally. Used for automatic logo resolution when adding apps.</small>
                </section>
              </div>

              <!-- Advanced Tab -->
              <div id="panel-advanced" class="tab-panel" role="tabpanel" aria-labelledby="tab-advanced" hidden>
                <section>
                  <h3 data-i18n="Performance">Performance</h3>
                  <div class="form-grid" style="grid-template-columns:140px 1fr;align-items:center;">
                    <label for="prefPruneAge" data-i18n="Cache Max Age (hrs)">Cache Max Age (hrs)</label>
                    <input id="prefPruneAge" type="number" min="1" max="48" step="1" placeholder="6" data-i18n-placeholder="6" />
                    <label for="prefPruneEntries" data-i18n="Cache Max Entries">Cache Max Entries</label>
                    <input id="prefPruneEntries" type="number" min="50" max="2000" step="50" placeholder="250" data-i18n-placeholder="250" />
                    <label for="prefPerfPanel" data-i18n="Perf Panel">Perf Panel</label>
                    <label class="switch" style="justify-self:start;">
                      <input id="prefPerfPanel" type="checkbox" />
                      <span class="switch-track" aria-hidden="true"></span>
                      <span class="switch-label-on" aria-hidden="true" data-i18n="On">On</span>
                      <span class="switch-label-off" aria-hidden="true" data-i18n="Off">Off</span>
                    </label>
                  </div>
                  <small class="muted" data-i18n="Adjust in-memory cache pruning (weather, RSS, etc.). ">Adjust in-memory cache pruning (weather, RSS, etc.). </small>
                </section>
              </div>

              <!-- Terminal / Repair Tab -->
              <div id="panel-repair" class="tab-panel" role="tabpanel" aria-labelledby="tab-repair" hidden>
                <section>
                  <h3>Terminal / Repair</h3>
                  <p class="muted">Run vetted PowerShell diagnostics and fixes. Commands are whitelisted; output and validation will appear below.</p>
                  <div class="repair-legend">
                    <span class="repair-badge safe">Safe</span>
                    <span class="muted" style="margin-right:12px;">routine diagnostics</span>
                    <span class="repair-badge danger">Caution</span>
                    <span class="muted">may interrupt services or require admin</span>
                  </div>
                  <div id="repairCommandGroups" class="repair-grid" aria-live="polite"></div>
                </section>
                <section>
                  <div class="repair-log-header">
                    <div>
                      <h3 style="margin:0;">Session output</h3>
                      <p class="muted" style="margin:4px 0 0;">Recent runs with 1-2 line validation summaries.</p>
                    </div>
                    <button id="repairLogClear" class="btn small" type="button">Clear log</button>
                  </div>
                  <div id="repairLog" class="repair-log" role="log" aria-live="polite" aria-label="Repair command output log"></div>
                </section>
              </div>

              <div id="panel-logs" class="tab-panel" role="tabpanel" aria-labelledby="tab-logs" hidden>
                <section>
                  <h3>Logs</h3>
                  <p class="muted">Uptime alert history (newest first). Entries are stored locally.</p>
                  <div class="form-grid" style="grid-template-columns:auto;align-items:center;">
                    <label class="switch" style="justify-self:start;" aria-label="Red status alert notifications">
                      <input id="prefUptimeAlerts" type="checkbox" />
                      <span class="switch-track" aria-hidden="true"></span>
                      <span class="switch-label-on" aria-hidden="true">On</span>
                      <span class="switch-label-off" aria-hidden="true">Off</span>
                    </label>
                  </div>
                  <div class="form-grid" style="grid-template-columns: 200px 1fr; align-items: center;">
                    <label for="prefUptimeAlertInterval">Alert repeat interval</label>
                    <div style="display:flex;align-items:center;gap:10px;">
                      <input type="range" id="prefUptimeAlertInterval" min="1" max="60" step="1" />
                      <span id="prefUptimeAlertIntervalLabel" style="min-width:50px;display:inline-block;">5 min</span>
                    </div>
                  </div>
                  <div class="uptime-log-wrap">
                    <div class="uptime-log-head">
                      <span>Log monitoring</span>
                      <div style="display:flex;align-items:center;gap:10px;">
                        <button id="uptimeLogClear" class="btn small" type="button">Clear</button>
                        <span class="muted" style="font-size:0.85rem;">Newest first</span>
                      </div>
                    </div>
                    <div class="uptime-export-row">
                      <span class="muted" style="font-size:0.9rem;">Download:</span>
                      <div class="uptime-export-buttons">
                        <button class="btn small" id="uptimeExportJson" type="button">JSON</button>
                        <button class="btn small" id="uptimeExportTxt" type="button">TXT</button>
                        <button class="btn small" id="uptimeExportPdf" type="button">PDF</button>
                      </div>
                    </div>
                    <div id="uptimeLogList" class="uptime-log-list"></div>
                  </div>
                  <div class="uptime-chart-card">
                    <div class="uptime-chart-head">
                      <div>
                        <div class="uptime-chart-title">Alerts summary</div>
                        <div class="muted" style="font-size:0.9rem;">Devices, total pings logged, and tabs count.</div>
                      </div>
                      <div id="uptimeChartTotals" class="uptime-chart-totals"></div>
                    </div>
                    <div class="uptime-chart-grid">
                      <canvas id="uptimePieCanvas" width="260" height="260" aria-label="Alerts summary pie chart"></canvas>
                      <div id="uptimePieLegend" class="uptime-pie-legend"></div>
                    </div>
                  </div>
                </section>
              </div>

              <div id="panel-credits" class="tab-credits" role="tabpanel" aria-labelledby="tab-credits" hidden>
                <section>
                  <div class="credits-list">
                    <div class="credit-item">
                      <img class="credit-avatar"
                        src="https://cdn.discordapp.com/avatars/333686085106401281/a4e4ab5a699a39fdc5c17170df54a48f.webp?size=128"
                        alt="Salc_RCC avatar">
                      <div class="credit-info">
                        <div class="credit-heading credit-heading--inline">
                          <span class="credit-name">Calixto</span>
                          <span class="credit-tag" data-i18n="Senior Full Stack Developer">Senior Full Stack Developer</span>
                        </div>
                        <div class="credit-body">
                          <a class="credit-link" href="https://github.com/Salc-wm" target="_blank" rel="noopener noreferrer">https://github.com/Salc-wm</a>
                          <p class="credit-description" data-i18n="devSenior">Leads the system architecture and ensures the Control Center remains stable, efficient, and scalable.</p>
                        </div>
                      </div>
                    </div>
                    <div class="credit-item">
                      <img class="credit-avatar"
                        src="https://cdn.discordapp.com/avatars/1237801313648246794/8bce95cb2d9f94195c34bef8b1f0acd9.webp?size=128"
                        alt="Sergio Marquina avatar">
                      <div class="credit-info">
                        <div class="credit-heading credit-heading--inline">
                          <span class="credit-name">Sergio Marquina</span>
                          <span class="credit-tag" data-i18n="Jr. Software & UX Designer">Jr. Software & UX Designer</span>
                        </div>
                        <div class="credit-body">
                          <a class="credit-link" href="https://cybersecurity-solution.net/" target="_blank" rel="noopener noreferrer">https://cybersecurity-solution.net/</a>
                          <p class="credit-description" data-i18n="devUX">Leads UX direction and design systems that keep every flow intuitive.</p>
                        </div>
                      </div>
                    </div>
                    <div class="credit-item">
                      <img class="credit-avatar"
                        src="https://cdn.discordapp.com/avatars/848850740592377887/0c3a5f28465d4b582480c8ce7489154c.webp?size=128"
                        alt="Folke avatar">
                      <div class="credit-info">
                        <div class="credit-heading credit-heading--inline">
                          <span class="credit-name">Folke™</span>
                          <span class="credit-tag" data-i18n="Dashboard Developer">Dashboard Developer</span>
                        </div>
                        <div class="credit-body">
                          <p class="credit-description" data-i18n="devCreativity">Designs engaging game title mechanics for the dashboard feature that dynamically pulls game titles, keeping creativity and team morale high between releases.</p>
                        </div>
                      </div>
                    </div>
                    <div class="credit-item">
                      <img class="credit-avatar"
                        src="https://cdn.discordapp.com/avatars/343810250039754762/e0a43b22a94ccb88312f47ca31f729a5.webp?size=128"
                        alt="Autismo Skuba avatar">
                      <div class="credit-info">
                        <div class="credit-heading credit-heading--inline">
                          <span class="credit-name">Autismo Skuba</span>
                          <span class="credit-tag" data-i18n="UI Effects Engineer">UI Effects Engineer</span>
                        </div>
                        <div class="credit-body">
                          <a class="credit-link" href="https://github.com/AutismoSkuba" target="_blank" rel="noopener noreferrer">https://github.com/AutismoSkuba</a>
                          <p class="credit-description" data-i18n="devUI">Engineers the glow system and polishes the dashboard's visual depth.</p>
                        </div>
                      </div>
                    </div>
                    <div class="credit-item">
                      <img class="credit-avatar"
                        src="https://cdn.discordapp.com/avatars/502273377906458624/a17b641b6cc118fffecc4596950b9163.webp?size=128"
                        alt="Stefan Schwarz avatar">
                      <div class="credit-info">
                        <div class="credit-heading credit-heading--inline">
                          <span class="credit-name">Stefan Schwarz</span>
                          <span class="credit-tag" data-i18n="Swiss Representative & Language Expert">Swiss Representative & Language Expert</span>
                        </div>
                        <div class="credit-body">
                          <p class="credit-description" data-i18n="devMulti-lingual">Providing multi-lingual access for worldwide support.</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <small class="muted credit-footer" data-i18n="thankAllcontributors">Thank you to all contributors who helped make this possible!</small>
                </section>
              </div>
            </div>
          </div>
        </aside>


    <!-- Modal -->
    <div id="modal" class="modal" hidden>
      <div class="modal-backdrop" data-action="closeModal"></div>
      <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal-header">
          <h2 id="modalTitle">Modal</h2>
          <button class="btn close-btn" data-action="closeModal">Close</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-footer" id="modalFooter"></div>
      </div>
    </div>

  </div>

  <script src="js/register-pwa.js" defer></script>
  <script type="module" src="js/favicon.js" defer></script>
  <script type="module" src="js/main.js" defer></script>
</body>
</html>
